rules:
- id: TS006
  name: Modified+Metachange Before Creation
  severity: High
  explanation: "Both $MFT modified+metachange (m.c.) is earlier than $MFT creation\
    \ (...b). Highly suspicious.\n\n Windows copy/paste and restore can cause single-modified\
    \ or single-metachange timestamps before creation, but 'modified+metachange' before\
    \ creation is not typical of any normal Windows operation. This strengthens the\
    \ signal for timestomping regardless of path/location."
  logic:
    all_of:
    - condition: datetime($MFT.modified_metachange) < datetime($MFT.creation)
    - condition: datetime($USN_JOURNAL.USN_REASON_BASIC_INFO_CHANGE, mode=lax) < datetime($MFT.creation)
  targets:
  - '*'
