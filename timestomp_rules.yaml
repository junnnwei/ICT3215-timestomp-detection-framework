rules:
  - id: TS001
    name: "Execution-before-Creation"
    description: "File executed before any creation evidence exists."
    severity: "High"

    entities:
      - "$MFT"
      - "PREFETCH"
      - "AMCACHE"
      - "APPCOMPATCACHE"

    logic:
      any_of:
        - condition: "datetime(PREFETCH) < datetime($MFT)"
        - condition: "datetime(AMCACHE) < datetime($MFT)"
        - condition: "datetime(APPCOMPATCACHE) < datetime($MFT)"

      explanation: "Execution evidence predates file creation - possible timestomping."

  - id: TS002
    name: "Modification-During-Power-Off"
    severity: "Critical"
    entities:
      - "$MFT"
      - "BOOT_SESSIONS"
    logic:
      all_of:
        - condition: "datetime($MFT, macb='m.c.') not between (BOOT_SESSIONS)"
      explanation: "File modified when system was powered off."
