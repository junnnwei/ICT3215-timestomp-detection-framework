rules:
  # - id: TS001
  #   name: "Execution-before-Creation"
  #   description: "File executed before any creation evidence exists."
  #   severity: "High"

  #   targets:
  #   - "*"

  #   logic:
  #     any_of:
  #       - condition: "datetime(PREFETCH) < datetime($MFT, macb='...b')"
  #       - condition: "datetime(AMCACHE) < datetime($MFT, macb='...b')"
  #       - condition: "datetime(APPCOMPATCACHE) < datetime($MFT, macb='.a..')"
  #     explanation: "Execution evidence predates file creation - possible timestomping."

  # - id: TS002
  #   name: "Modification-During-Power-Off"
  #   severity: "Critical"

  #   logic:
  #     all_of:
  #       - condition: "datetime($MFT, macb='...b') not between (BOOT_SESSIONS)"
  #       - condition: "datetime(PREFETCH) not between (BOOT_SESSIONS)"
  #     explanation: "File modified when system was powered off."

  # - id: TS003
  #   name: "Prefetch-Execution-During-Logoff"
  #   severity: "High"

  #   targets:
  #   - "users/timel/desktop/cases/creation_future.exe"
  
  #   logic:
  #     all_of:
  #       - condition: "datetime(PREFETCH.datetime) not between (AUTH_SESSIONS)"
  #     explanation: "File executed (Prefetch) when system was powered off."

  - id: TS003
    name: "File creation not between AUTH Sessions"
    severity: "High"

    targets:
    - "users/timel/desktop/cases/creation_future.exe"
  
    logic:
      all_of:
        - condition: "datetime($MFT.creation) not between (AUTH_SESSIONS)"
      explanation: "File executed (Prefetch) when system was powered off."

  # - id: TS004
  #   name: "Execution-before-Creation"
  #   description: "File executed before any creation evidence exists."
  #   severity: "High"

  #   targets:
  #   - "*"

  #   logic:
  #     any_of:
  #       - condition: "datetime(PREFETCH) < datetime($MFT, macb='...b')"
  #       - condition: "datetime(AMCACHE) < datetime($MFT, macb='...b')"
  #       - condition: "datetime(APPCOMPATCACHE) < datetime($MFT, macb='...b')"
  #     explanation: "Execution evidence predates file creation - possible timestomping."

  # - id: TS005
  #   name: "Execution-before-Creation"
  #   description: "File executed before any creation evidence exists."
  #   severity: "High"

  #   targets:
  #   - "users/timel/desktop/cases/creation_future.exe"

  #   logic:
  #     any_of:
  #       - condition: "datetime(PREFETCH.firstrun) < datetime($MFT.modified_metachange)"
  #       - condition: "datetime(AMCACHE.datetime) < datetime($MFT.modified_metachange)"
  #       - condition: "datetime(APPCOMPATCACHE.datetime) < datetime($MFT.modified_metachange)"
  #     explanation: "Execution evidence predates file creation - possible timestomping."
